#!/usr/bin/env bash
# Git post-merge hook: Run file organization check after merges/pulls

set -euo pipefail

# Get hook parameters
squash_merge="$1"

echo "üîÑ Running file organization check after merge/pull..."

# Run organization check in report mode
# Use CLAUDE_PROJECT_DIR if available, otherwise find the repository root
if [ -n "${CLAUDE_PROJECT_DIR:-}" ]; then
    repo_root="$CLAUDE_PROJECT_DIR"
else
    repo_root=$(git rev-parse --show-toplevel)
fi
script_path="$repo_root/.genesis/scripts/validation/check-file-organization.sh"

if [ -f "$script_path" ]; then
    cd "$repo_root" && "$script_path"
else
    echo "‚ö†Ô∏è  File organization script not found - skipping check"
fi

exit 0
