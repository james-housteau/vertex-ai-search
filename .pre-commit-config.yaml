# Genesis Universal Pre-commit Configuration
# Ensures code quality and consistency before commits across all project types

repos:
  # Branch protection - prevents commits to main branch
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v6.0.0
    hooks:
      # CRITICAL: Block direct commits to main branch
      - id: no-commit-to-branch
        args: ['--branch', 'main', '--branch', 'master']
        name: ðŸ”’ Main branch protection
        description: |
          Direct commits to main/master branches are blocked for safety.

          To commit your changes:
          1. Create a feature branch: git checkout -b feature/your-change
          2. Make your commits on the feature branch
          3. Use pull requests to merge to main

          This protects the main branch from accidental commits.

      # Essential file validation
      - id: check-yaml
        exclude: ^(docker-compose\.yml|\.github/workflows/|modules/.*\.yaml|monitoring/.*\.yaml|deploy/.*\.yml)
      - id: check-json
      - id: check-toml
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-ast
        files: \.py$
      - id: forbid-new-submodules
      - id: check-executables-have-shebangs
        files: \.(py|sh|bash)$
      - id: fix-byte-order-marker
      - id: check-added-large-files
        args: ['--maxkb=1000']
      - id: detect-private-key
      - id: debug-statements
      - id: check-merge-conflict

  # NO SHORTCUTS POLICY - prevents code quality shortcuts from reaching main
  - repo: local
    hooks:
      - id: no-shortcuts
        name: Block code quality shortcuts
        description: Prevents type ignores, noqa, and other quality shortcuts from being committed
        entry: .genesis/scripts/validation/check-no-shortcuts.sh
        language: script
        files: \.(py|ts|tsx|js|jsx|go|tf)$
        exclude: ^(archive/|experiments/)
        pass_filenames: true
        verbose: true

  # Essential security - secret detection
  - repo: https://github.com/zricethezav/gitleaks
    rev: v8.28.0
    hooks:
      - id: gitleaks

  # Genesis quality gates
  - repo: local
    hooks:
      - id: no-hardcoded-values
        name: Block hardcoded values
        description: Prevents hardcoded configuration values from being committed
        entry: .genesis/scripts/validation/find-hardcoded-values.sh
        language: script
        files: \.(py|ts|tsx|js|jsx|go)$
        pass_filenames: false
        verbose: true
        stages: [manual]
